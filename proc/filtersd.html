<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Modern Fortran Implementation of the filterSD Optimization Method">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>filterSD &ndash; filterSD</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">filterSD </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            
    <li><a href="../lists/blockdata.html">Block Data Units</a></li>
    
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>




<li class="visible-xs hidden-sm visible-lg"><a href="../lists/blockdata.html">Block Data Units</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>filterSD
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">69 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/filterSD.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/filtersd.f90.html'>filterSD.f90</a></li>
    
  
     <li class="active">filterSD</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 


<div class="panel panel-primary">
  <div class="panel-heading
  text-left"><h3 class="panel-title"><a data-toggle="collapse"
  href="#common-0">Common Blocks</a></h3></div>
  <div id="common-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/filtersd.html#common-wsc~2">wsc</a>
      
      <a class="list-group-item" href="../proc/filtersd.html#common-defaultc">defaultc</a>
      
      <a class="list-group-item" href="../proc/filtersd.html#common-functc">functc</a>
      
    </div>
  </div>
</div>





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/filtersd.html#src">filterSD</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
subroutine filterSD(n, m, x, al, f, fmin, cstype, bl, bu, ws, lws, v, nv, maxa, maxla, maxu, maxiu, kmax, maxg, rho, htol, rgtol, maxit, iprint, nout, ifail)
    
    
   
</h2>
    
  


    
    <p>Copyright (C) 2010 Roger Fletcher</p>
<p>Current version dated 5 October 2011</p>
<p>THE ACCOMPANYING PROGRAM IS PROVIDED UNDER THE TERMS OF THE ECLIPSE PUBLIC
  LICENSE ("AGREEMENT"). ANY USE, REPRODUCTION OR DISTRIBUTION OF THE PROGRAM
  CONSTITUTES RECIPIENT'S ACCEPTANCE OF THIS AGREEMENT</p>
<p>Solves an NLP problem of the form: find a local solution x to</p>
<div class="codehilite"><pre><span></span><code>  minimize    f(x)
                    [  x   ]
  subject to  bl &lt;= [      ] &lt;= bu
                    [ c(x) ]
</code></pre></div>

<p>where f(x) is a given function of n variables x and c(x) is a vector of m
  given constraint functions. f(x) is minimized subject to lower and upper
  bounds bl and bu on x and c(x). f(x) and c(x) are defined by a user supplied
  subroutine 'functions'. The user is also required to supply a subroutine
  'gradients' which calculates gradients of f(x) and c(x) with respect to x.</p>
<p>If linearized constraints and the trust region are incompatible, the code
  enters 'phase 1' in which an 'l1 feasibility problem' is solved. If this
  is unsuccessful in resolving the situation then the code exits with
  ifail=3 and returns a 'locally infeasible point' in x.</p>
<h3>Parameter List  (variables in a line starting with C must be set on entry)</h3>
<p>n     number of variables
  m     number of general constraints
  x(n+m)  x(1:n) stores the vector of variables. Initially an estimate of the
            solution must be set, replaced by the solution (if it exists)
            on exit. The rest of x is workspace
  al(n+m) stores Lagrange multipliers at the solution on exit. A positive
            multiplier indicates that the lower bound is active, and a
            negative multiplier indicates that the upper bound is active.
            Inactive constraints have a zero multiplier.
  f     returns the value of f(x) when x is a feasible solution
  fmin  set a strict lower bound on f(x) for feasible x (used to identify
          an unbounded NLP)
  cstype(m) character workspace: if ifail=3, cstype indicates constraints
              that are infeasible in the L1 solution. cstype(i)='A' if the
              lower bound on c/s i is infeasible, 'Z' if the upper bound is
              infeasible, else 'N' if feasible.
  bl(n+m) lower bounds on x and c(x) (use numbers no less than -ainfty
            (see below) and where possible supply realistic bounds on x)
  bu(n+m) upper bounds on x and c(x) (use numbers no greater than ainfty)
  ws(<em>)   double precision workspace
  lws(</em>)  integer workspace
  v(maxg) stores nv Ritz values (estimates of eigenvalues of reduced Hessian)
            supply the setting from a previous run of filterSD, or set
            nv=1 and v(1)=1.D0 in absence of other information
  nv      number of values set in v
  maxa    maximum number of entries in the Jacobian a(<em>) set by gradients
  maxla   number of entries required for sparse matrix indices and pointers
            la(0:</em>) to be set up in lws(<em>) (maxla&gt;=maxa+m+3).
            Set maxla=1 if using dense matrix format
  maxu    length of workspace user(</em>) passed through to user subroutines
            'functions' and 'gradients'
  maxiu   length of workspace iuser(*) passed through to user subroutines
  kmax    maximum dimension of null space allowed for (kmax&lt;=n)
  maxg    maximum number of reduced gradient vectors stored by the
            limited memory method (typically 6 or 7)
  rho     initial trust region radius (typically 1.D1)
  htol    tolerance allowed in sum h of constraint feasibilities (e.g. 1.D-6)
  rgtol   tolerance allowed in reduced gradient l2 norm (typically 1.D-4)
  maxit   maximum number of major iterations allowed
  iprint  verbosity of printing (0=none, 1=one line per iteration,
            2=additional text information given)
  nout    output channel for printing
  ifail   returns failure indication as follows
              0 = successful run
              1 = unbounded NLP (f &lt;= fmin at an htol-feasible point)
              2 = bounds on x are inconsistent
              3 = local minimum of feasibility problem and h &gt; htol
                  (nonlinear constraints are locally inconsistent)
              4 = initial point x has h &gt; ubd (reset ubd or x and re-enter)
              5 = maxit major iterations have been carried out
              6 = termination with rho &lt;= htol
              7 = not enough workspace in ws or lws (see message)
              8 = insufficient space for filter (increase mxf and re-enter)
             &gt;9 = unexpected fail in LCP solver (10 has been added to ifail)</p>
<h3>User Routines</h3>
<p>The user must supply two subroutines to calculate f(x), c(x) and their
  first derivatives as follows</p>
<div class="codehilite"><pre><span></span><code>     <span class="k">subroutine </span><span class="n">functions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">user</span><span class="p">,</span><span class="n">iuser</span><span class="p">)</span>
     <span class="k">implicit </span><span class="kt">double precision</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">h</span><span class="p">,</span><span class="n">o</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>
     <span class="k">dimension </span><span class="n">x</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">c</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">user</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">iuser</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
     <span class="c">!...</span>
     <span class="c">!Statements to calculate f(x) and the m-vector c(x). The user is</span>
     <span class="c">!responsible for ensuring that any failures such as IEEE errors</span>
     <span class="c">!(overflow, NaN&#39;s etc.) are trapped and not returned to filterSD.</span>
     <span class="c">!The same holds for gradients.</span>
     <span class="c">!...</span>
     <span class="k">return</span>
<span class="k">     end</span>

<span class="k">     subroutine </span><span class="n">gradients</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">user</span><span class="p">,</span><span class="n">iuser</span><span class="p">)</span>
     <span class="k">implicit </span><span class="kt">double precision</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">h</span><span class="p">,</span><span class="n">o</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>
     <span class="k">dimension </span><span class="n">x</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">a</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">user</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">iuser</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
     <span class="c">!...</span>
     <span class="c">!Statements to calculate gradients of f(x) and c(x) and set in a(*).</span>
     <span class="c">!The column vector grad(f) must be followed by the column vectors</span>
     <span class="c">!grad(c_i), i=1,2,...,m, in the one dimensional array a(*). Either a</span>
     <span class="c">!dense or sparse data structure may be used. If using the sparse data</span>
     <span class="c">!structure, only stucturally non-zero entries are set. Pointers etc. for</span>
     <span class="c">!the data structure are set once and for all in lws as described below.</span>
     <span class="c">!The user may assume that a call of &#39;gradients&#39; immediately follows one</span>
     <span class="c">! of &#39;functions&#39; with the same vector x.)</span>
     <span class="c">!...</span>
     <span class="k">return</span>
<span class="k">     end</span>
</code></pre></div>

<p>The user must also supply a driver routine which calls filterSD. This must
  set parameters and common blocks of filterSD as appropriate.
  Space for x,al,bl,bu,ws,lws,v and cstype must be assigned.
  If using the sparse data structure for setting gradients, indices and
  pointers la(0:maxla-1) must be set in the driver in lws, immediately
  following any user workspace in lws(1:maxiu). No changes in this
  data structure are allowed during the operation of filterSD.
  More details of the format of a(<em>) and la(</em>) are given in the file sparseA.f
  For dense format just set maxla=1 and set lws(maxiu+1) to the
  'stride' (&gt;=n) used in setting the columns of grad(f) and grad(c_i).
  For efficiency, constant entries in the gradients may be set in the driver.
  However two copies of the gradients are kept by filterSD . These reside in
  ws(maxu+1:maxu+maxa) and ws(maxu+maxa+1:maxu+2*maxa). Any constant entries
  must be set in both copies.</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n~29"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-m~7"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>m</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x~11"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-al"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>al</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f~4"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>f</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fmin"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>fmin</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cstype"></span>character</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>cstype</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-bl~7"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>bl</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-bu~7"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>bu</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ws~3"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ws</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lws~3"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>lws</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v~3"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>v</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nv~4"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nv</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxa~2"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>maxa</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxla"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>maxla</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxu"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>maxu</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxiu"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>maxiu</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kmax~3"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>kmax</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxg~3"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>maxg</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rho"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rho</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-htol"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>htol</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rgtol~2"></span>real</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rgtol</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxit"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>maxit</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iprint~3"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iprint</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nout~5"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nout</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ifail~3"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ifail</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 


<div class="panel panel-primary">
  <div class="panel-heading
  text-left"><h3 class="panel-title"><a data-toggle="collapse"
  href="#common-1">Common Blocks</a></h3></div>
  <div id="common-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/filtersd.html#common-wsc~2">wsc</a>
      
      <a class="list-group-item" href="../proc/filtersd.html#common-defaultc">defaultc</a>
      
      <a class="list-group-item" href="../proc/filtersd.html#common-functc">functc</a>
      
    </div>
  </div>
</div>





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/filtersd.html#src">filterSD</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    
    <section>
      <h2>Common Blocks</h2>
      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-wsc~2"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4><a href='../proc/l1sold.html#common-wsc'>l1sold</a> (subroutine)<br><a href='../proc/start_up.html#common-wsc~3'>start_up</a> (subroutine)<br><a href='../proc/start_up~2.html#common-wsc~4'>start_up</a> (subroutine)<br><a href='../proc/qlcpd.html#common-wsc~5'>qlcpd</a> (subroutine)<br><a href='../proc/stmapq.html#common-wsc~6'>stmapq</a> (subroutine)<br><a href='../proc/start_up~3.html#common-wsc~7'>start_up</a> (subroutine)<br><a href='../proc/glcpd.html#common-wsc~8'>glcpd</a> (subroutine)<br><a href='../proc/stmap.html#common-wsc~9'>stmap</a> (subroutine)<br><a href='../blockdata/defaults.html#common-wsc~10'>defaults</a> (blockdata)<br>">common /wsc/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kk~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>kk</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ll~4"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ll</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kkk~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>kkk</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lll~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>lll</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mxws~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>mxws</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mxlws~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>mxlws</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-defaultc"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4><a href='../proc/filter_sd.html#common-defaultc~2'>filter_SD</a> (subroutine)<br><a href='../proc/funct.html#common-defaultc~3'>funct</a> (subroutine)<br><a href='../proc/grad.html#common-defaultc~4'>grad</a> (subroutine)<br><a href='../blockdata/nlp_defaults.html#common-defaultc~5'>nlp_defaults</a> (blockdata)<br>">common /defaultc/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ainfty"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>ainfty</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ubd"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>ubd</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mlp~2"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>mlp</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mxf"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>mxf</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
      
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="common-functc"></span><h3>
      <a data-toggle="popover" data-html="true" tabindex="0" 
     data-trigger="focus"
   data-content="<h4>Used Elsewhere:</h4><a href='../proc/filter_sd.html#common-functc~2'>filter_SD</a> (subroutine)<br><a href='../proc/funct.html#common-functc~3'>funct</a> (subroutine)<br><a href='../proc/grad.html#common-functc~4'>grad</a> (subroutine)<br>">common /functc/</a>
      
  </h3></div>
  <div class="panel-body">
    
    
    
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fxd"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>fxd</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-alc"></span>real</td>
  
  
  <td></td><td>::</td>
  <td><strong>alc</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-m_"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>m_</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iph"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>iph</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-last1"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>last1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-next1"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>next1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nx"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>nx</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nx1"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>nx1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nal"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>nal</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nal1"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>nal1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-naal"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>naal</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-naal1"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>naal1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nxd"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>nxd</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nxd1"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>nxd1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ncx"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ncx</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ncx1"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ncx1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ncxd"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ncxd</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ncxd1"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>ncxd1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nla1"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>nla1</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    
</div>
</div>

      
    </section>
    <br>
    <script>
      $(function () {
      $('[data-toggle="popover"]').popover()
      })
    </script>
    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">filterSD</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">al</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">fmin</span><span class="p">,</span><span class="n">cstype</span><span class="p">,</span><span class="n">bl</span><span class="p">,</span><span class="n">bu</span><span class="p">,</span><span class="n">ws</span><span class="p">,</span><span class="n">lws</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">nv</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">maxa</span><span class="p">,</span><span class="n">maxla</span><span class="p">,</span><span class="n">maxu</span><span class="p">,</span><span class="n">maxiu</span><span class="p">,</span><span class="n">kmax</span><span class="p">,</span><span class="n">maxg</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">htol</span><span class="p">,</span><span class="n">rgtol</span><span class="p">,</span><span class="n">maxit</span><span class="p">,</span><span class="n">iprint</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">nout</span><span class="p">,</span><span class="n">ifail</span><span class="p">)</span>

      <span class="k">implicit </span><span class="kt">double precision</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">h</span><span class="p">,</span><span class="n">o</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>
      <span class="k">dimension </span><span class="n">x</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">al</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">bl</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">bu</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">ws</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">lws</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">v</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
      <span class="kt">character </span><span class="n">cstype</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>

<span class="c">!  Common blocks</span>
<span class="c">!  =============</span>
<span class="c">!      common/wsc/kk,ll,kkk,lll,mxws,mxlws</span>
<span class="c">!  The user must specify the length of the workspace arrays ws(*) and lws(*)</span>
<span class="c">!  in mxws and mxlws respectively. It may not be easy to specify a-priori how</span>
<span class="c">!  large these arrays should be. Set a suitable large estimate, and filterSD</span>
<span class="c">!  will prompt if larger values are required. As a guide, ws(*) contains</span>
<span class="c">!  first user workspace, then workspace for filterSD, then workspace for glcpd,</span>
<span class="c">!  and finally workspace for denseL.f or schurQR.f. lws(*) contains user</span>
<span class="c">!  workspace, then maxla+n+m+mlp locations for filterSD and additional locations</span>
<span class="c">!  for denseL.f or schurQR.f.</span>
<span class="c">!     common/defaultc/ainfty,ubd,mlp,mxf</span>
<span class="c">!  Default values of some control parameters are set here. ainfty is used to</span>
<span class="c">!  represent infinity. ubd provides an upper bound on the allowed constraint</span>
<span class="c">!  violation. mlp is the maximum length of arrays used in degeneracy control.</span>
<span class="c">!  mxf is the maximum length of filter arrays. Default values are 1.D20, 1.D4,</span>
<span class="c">!  50,  50 respectively.</span>
<span class="c">!     common/ngrc/mxgr</span>
<span class="c">!  The user can limit the time spent in each call of the LCP solver by setting</span>
<span class="c">!  an upper limit on the number of gradient calls in mxgr (default=1000000)</span>
<span class="c">!     common/mxm1c/mxm1</span>
<span class="c">!  When using denseL.f, mxm1 must be set to the maximum number of general</span>
<span class="c">!  constraints allowed in the active set. mxm1=min(m+1,n) is always sufficient</span>
<span class="c">!     common/epsc/eps,tol,emin</span>
<span class="c">!     common/repc/sgnf,nrep,npiv,nres</span>
<span class="c">!  These common blocks provide default parameters that control glcpd</span>
<span class="c">!     common/statsc/dnorm,h,hJt,hJ,ipeq,k,itn,nft,ngt</span>
<span class="c">!  This common block returns information about the outcome of filterSD.</span>
<span class="c">!  dnorm=final step length, h=final c/s violation, hJt=ditto for &#39;N&#39; c/s,</span>
<span class="c">!  hJ=ditto for &#39;A&#39; and &#39;Z&#39; c/s, ipeq=number of active equations, k=number of</span>
<span class="c">!  free variables, itn=number of iterations, nft=total number of function</span>
<span class="c">!  calls, ngt=total number of gradient calls</span>

      <span class="k">common</span><span class="o">/</span><span class="n">wsc</span><span class="o">/</span><span class="n">kk</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span><span class="n">kkk</span><span class="p">,</span><span class="n">lll</span><span class="p">,</span><span class="n">mxws</span><span class="p">,</span><span class="n">mxlws</span>
      <span class="k">common</span><span class="o">/</span><span class="n">defaultc</span><span class="o">/</span><span class="n">ainfty</span><span class="p">,</span><span class="n">ubd</span><span class="p">,</span><span class="n">mlp</span><span class="p">,</span><span class="n">mxf</span>
      <span class="k">common</span><span class="o">/</span><span class="n">functc</span><span class="o">/</span><span class="n">fxd</span><span class="p">,</span><span class="n">alc</span><span class="p">,</span><span class="n">m_</span><span class="p">,</span><span class="n">iph</span><span class="p">,</span><span class="n">last1</span><span class="p">,</span><span class="n">next1</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="n">nx1</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="n">nal</span><span class="p">,</span><span class="n">nal1</span><span class="p">,</span><span class="n">naal</span><span class="p">,</span><span class="n">naal1</span><span class="p">,</span><span class="n">nxd</span><span class="p">,</span><span class="n">nxd1</span><span class="p">,</span><span class="n">ncx</span><span class="p">,</span><span class="n">ncx1</span><span class="p">,</span><span class="n">ncxd</span><span class="p">,</span><span class="n">ncxd1</span><span class="p">,</span><span class="n">nla1</span>

      <span class="n">m_</span><span class="o">=</span><span class="n">m</span>
      <span class="n">nm</span><span class="o">=</span><span class="n">n</span><span class="o">+</span><span class="n">m</span>
<span class="c">!  set real storage map for ws</span>
<span class="c">!  first maxu locations are user storage for functions and gradients</span>
<span class="c">!  vectors required by funct: two slots of length maxa for a(*)</span>
      <span class="n">last1</span><span class="o">=</span><span class="n">maxu</span><span class="o">+</span><span class="mi">1</span>
      <span class="n">next1</span><span class="o">=</span><span class="n">last1</span><span class="o">+</span><span class="n">maxa</span>
<span class="c">!  slot of length n for x</span>
      <span class="n">nx1</span><span class="o">=</span><span class="n">next1</span><span class="o">+</span><span class="n">maxa</span>
      <span class="n">nx</span><span class="o">=</span><span class="n">nx1</span><span class="o">-</span><span class="mi">1</span>
<span class="c">!  slot of length m for lambda</span>
      <span class="n">nal</span><span class="o">=</span><span class="n">nx</span><span class="o">+</span><span class="n">n</span>
      <span class="n">nal1</span><span class="o">=</span><span class="n">nal</span><span class="o">+</span><span class="mi">1</span>
<span class="c">!  slot of length n for Ak.al, or for storing x</span>
      <span class="n">naal</span><span class="o">=</span><span class="n">nal</span><span class="o">+</span><span class="n">m</span>
      <span class="n">naal1</span><span class="o">=</span><span class="n">naal</span><span class="o">+</span><span class="mi">1</span>
<span class="c">!  slot of length n for x at x+d</span>
      <span class="n">nxd</span><span class="o">=</span><span class="n">naal</span><span class="o">+</span><span class="n">n</span>
      <span class="n">nxd1</span><span class="o">=</span><span class="n">nxd</span><span class="o">+</span><span class="mi">1</span>
<span class="c">!  slot of length m for c at x</span>
      <span class="n">ncx</span><span class="o">=</span><span class="n">nxd</span><span class="o">+</span><span class="n">n</span>
      <span class="n">ncx1</span><span class="o">=</span><span class="n">ncx</span><span class="o">+</span><span class="mi">1</span>
<span class="c">!  slot of length m for c at x+d</span>
      <span class="n">ncxd</span><span class="o">=</span><span class="n">ncx</span><span class="o">+</span><span class="n">m</span>
      <span class="n">ncxd1</span><span class="o">=</span><span class="n">ncxd</span><span class="o">+</span><span class="mi">1</span>
<span class="c">!  local storage for filter_SD</span>
<span class="c">!  slot of length n for d</span>
      <span class="n">id1</span><span class="o">=</span><span class="n">ncxd1</span><span class="o">+</span><span class="n">m</span>
<span class="c">!  slot of length n+m for dl</span>
      <span class="n">idl1</span><span class="o">=</span><span class="n">id1</span><span class="o">+</span><span class="n">n</span>
<span class="c">!  slot of length n+m for du</span>
      <span class="n">idu1</span><span class="o">=</span><span class="n">idl1</span><span class="o">+</span><span class="n">nm</span>
<span class="c">!  slot of length n for g</span>
      <span class="n">ig1</span><span class="o">=</span><span class="n">idu1</span><span class="o">+</span><span class="n">nm</span>
<span class="c">!  slot of length n+m for e</span>
      <span class="n">ie1</span><span class="o">=</span><span class="n">ig1</span><span class="o">+</span><span class="n">n</span>
<span class="c">!  slot of length mlp for alp</span>
      <span class="n">ialp1</span><span class="o">=</span><span class="n">ie1</span><span class="o">+</span><span class="n">nm</span>
<span class="c">!  slot of length mxf for filh</span>
      <span class="n">ifilh1</span><span class="o">=</span><span class="n">ialp1</span><span class="o">+</span><span class="n">mlp</span>
<span class="c">!  slot of length mxf for filf</span>
      <span class="n">ifilf1</span><span class="o">=</span><span class="n">ifilh1</span><span class="o">+</span><span class="n">mxf</span>
<span class="c">!  total length of ws so far</span>
      <span class="n">kk</span><span class="o">=</span><span class="n">ifilf1</span><span class="o">+</span><span class="n">mxf</span><span class="o">-</span><span class="mi">1</span>

<span class="c">!  set integer storage map for lws</span>
<span class="c">!  first maxiu locations are user storage for functions and gradients</span>
<span class="c">!  storage of length maxla for la(0:*)</span>
      <span class="n">nla1</span><span class="o">=</span><span class="n">maxiu</span><span class="o">+</span><span class="mi">1</span>
<span class="c">!  local storage for filter_SD</span>
<span class="c">!  slot of length n+m for ls</span>
      <span class="n">ils1</span><span class="o">=</span><span class="n">nla1</span><span class="o">+</span><span class="n">maxla</span>
      <span class="n">ils</span><span class="o">=</span><span class="n">ils1</span><span class="o">-</span><span class="mi">1</span>
<span class="c">!  slot of length mlp for lp</span>
      <span class="n">ilp1</span><span class="o">=</span><span class="n">ils1</span><span class="o">+</span><span class="n">nm</span>
<span class="c">!  total length of lws so far</span>
      <span class="n">ll</span><span class="o">=</span><span class="n">ilp1</span><span class="o">+</span><span class="n">mlp</span><span class="o">-</span><span class="mi">1</span>

      <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">bl</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="n">bu</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">iprint</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">nout</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;simple bounds infeasible&#39;</span>
          <span class="n">ifail</span><span class="o">=</span><span class="mi">2</span>
          <span class="k">return</span>
<span class="k">        end if</span>
<span class="k">        </span><span class="n">ws</span><span class="p">(</span><span class="n">nx</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">bl</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span><span class="n">bu</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
      <span class="k">end do</span>

<span class="c">!  note x and al are just used as workspace: the true values are those in ws</span>

      <span class="k">call </span><span class="n">filter_SD</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">fmin</span><span class="p">,</span><span class="n">cstype</span><span class="p">,</span><span class="n">bl</span><span class="p">,</span><span class="n">bu</span><span class="p">,</span><span class="n">ws</span><span class="p">,</span><span class="n">lws</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">nv</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="n">maxa</span><span class="p">,</span><span class="n">kmax</span><span class="p">,</span><span class="n">maxg</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="n">ws</span><span class="p">(</span><span class="n">id1</span><span class="p">),</span><span class="n">ws</span><span class="p">(</span><span class="n">idl1</span><span class="p">),</span><span class="n">ws</span><span class="p">(</span><span class="n">idu1</span><span class="p">),</span><span class="n">ws</span><span class="p">(</span><span class="n">ig1</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="n">al</span><span class="p">,</span><span class="n">ws</span><span class="p">(</span><span class="n">ie1</span><span class="p">),</span><span class="n">lws</span><span class="p">(</span><span class="n">ils1</span><span class="p">),</span> <span class="p">&amp;</span>
        <span class="n">ws</span><span class="p">(</span><span class="n">ialp1</span><span class="p">),</span><span class="n">lws</span><span class="p">(</span><span class="n">ilp1</span><span class="p">),</span><span class="n">ws</span><span class="p">(</span><span class="n">ifilh1</span><span class="p">),</span><span class="n">ws</span><span class="p">(</span><span class="n">ifilf1</span><span class="p">),</span><span class="n">rho</span><span class="p">,</span><span class="n">htol</span><span class="p">,</span><span class="n">rgtol</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="n">maxit</span><span class="p">,</span><span class="n">iprint</span><span class="p">,</span><span class="n">nout</span><span class="p">,</span><span class="n">ifail</span><span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">ifail</span><span class="o">&gt;=</span><span class="mi">7</span><span class="p">)</span> <span class="k">return</span>
<span class="c">!  scatter ws(nx.. and ws(nal.. and bound multipliers into x and al</span>
      <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
        <span class="n">al</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mf">0.D0</span>
      <span class="k">end do</span>
<span class="k">      do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span>
        <span class="n">al</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">ws</span><span class="p">(</span><span class="n">nal</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
      <span class="k">end do</span>
<span class="k">      do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
        <span class="n">i</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">lws</span><span class="p">(</span><span class="n">ils</span><span class="o">+</span><span class="n">j</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">ws</span><span class="p">(</span><span class="n">nx</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="n">bl</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">then</span>
<span class="k">            </span><span class="n">al</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
          <span class="k">else if</span> <span class="p">(</span><span class="n">ws</span><span class="p">(</span><span class="n">nx</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="n">bu</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">then</span>
<span class="k">            </span><span class="n">al</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
          <span class="k">end if</span>
<span class="k">        end if</span>
<span class="k">      end do</span>
<span class="k">      do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
        <span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">ws</span><span class="p">(</span><span class="n">nx</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
      <span class="k">end do</span>

<span class="k">      return</span>
<span class="mi">1</span>     <span class="k">format</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">15</span><span class="n">I5</span><span class="p">)</span>
    <span class="k">end subroutine </span><span class="n">filterSD</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> filterSD was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>